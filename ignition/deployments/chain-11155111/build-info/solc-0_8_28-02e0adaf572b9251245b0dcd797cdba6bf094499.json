{
  "_format": "hh3-sol-build-info-1",
  "id": "solc-0_8_28-02e0adaf572b9251245b0dcd797cdba6bf094499",
  "solcVersion": "0.8.28",
  "solcLongVersion": "0.8.28+commit.7893614a",
  "userSourceNameMap": {
    "contracts/SkillMarketplace.sol": "project/contracts/SkillMarketplace.sol"
  },
  "input": {
    "language": "Solidity",
    "settings": {
      "evmVersion": "cancun",
      "optimizer": {
        "enabled": true,
        "runs": 200
      },
      "outputSelection": {
        "*": {
          "": [
            "ast"
          ],
          "*": [
            "abi",
            "evm.bytecode",
            "evm.deployedBytecode",
            "evm.methodIdentifiers",
            "metadata"
          ]
        }
      },
      "remappings": []
    },
    "sources": {
      "project/contracts/SkillMarketplace.sol": {
        "content": "// SPDX-License-Identifier: MIT\r\npragma solidity ^0.8.20;\r\n\r\n/**\r\n * @title SkillMarketplace\r\n * @notice Trustless escrow system for hiring verified talent\r\n * @dev Manages job listings, payments, and escrow\r\n */\r\ncontract SkillMarketplace {\r\n    // State Variables\r\n    uint256 public jobIdCounter;\r\n    uint256 public listingIdCounter;\r\n    uint256 public platformFeePercent = 2; // 2% platform fee\r\n    address public platformWallet;\r\n\r\n    // Job Structure (simplified to avoid stack too deep)\r\n    struct Job {\r\n        address provider;\r\n        address client;\r\n        uint256 price;\r\n        uint8 status; // 0=pending, 1=accepted, 2=completed, 3=paid, 4=cancelled\r\n        uint40 createdAt;\r\n    }\r\n\r\n    // Service Listing Structure (simplified)\r\n    struct ServiceListing {\r\n        address provider;\r\n        uint256 price;\r\n        bool isActive;\r\n    }\r\n\r\n    // Mappings\r\n    mapping(uint256 => Job) public jobs;\r\n    mapping(uint256 => ServiceListing) public serviceListings;\r\n    mapping(uint256 => string) public jobDescriptions;\r\n    mapping(uint256 => string) public listingTitles;\r\n    mapping(uint256 => string) public listingDescriptions;\r\n    mapping(address => uint256[]) public providerJobs;\r\n    mapping(address => uint256[]) public clientJobs;\r\n    mapping(address => uint256[]) public providerListings;\r\n\r\n    // Events\r\n    event ServiceListed(\r\n        uint256 indexed listingId,\r\n        address indexed provider,\r\n        uint256 price,\r\n        uint256 timestamp\r\n    );\r\n    event ServiceDelisted(uint256 indexed listingId, uint256 timestamp);\r\n    event JobCreated(\r\n        uint256 indexed jobId,\r\n        address indexed provider,\r\n        address indexed client,\r\n        uint256 price,\r\n        uint256 timestamp\r\n    );\r\n    event JobAccepted(uint256 indexed jobId, uint256 timestamp);\r\n    event JobCompleted(uint256 indexed jobId, uint256 timestamp);\r\n    event PaymentReleased(\r\n        uint256 indexed jobId,\r\n        address indexed provider,\r\n        uint256 amount,\r\n        uint256 timestamp\r\n    );\r\n    event JobCancelled(uint256 indexed jobId, uint256 timestamp);\r\n\r\n    // Modifiers\r\n    modifier onlyProvider(uint256 _jobId) {\r\n        require(jobs[_jobId].provider == msg.sender, \"Not provider\");\r\n        _;\r\n    }\r\n\r\n    modifier onlyClient(uint256 _jobId) {\r\n        require(jobs[_jobId].client == msg.sender, \"Not client\");\r\n        _;\r\n    }\r\n\r\n    modifier jobExists(uint256 _jobId) {\r\n        require(_jobId < jobIdCounter, \"Job does not exist\");\r\n        _;\r\n    }\r\n\r\n    constructor(address _platformWallet) {\r\n        require(_platformWallet != address(0), \"Invalid platform wallet\");\r\n        platformWallet = _platformWallet;\r\n    }\r\n\r\n    function createServiceListing(\r\n        string memory _title,\r\n        string memory _description,\r\n        uint256 _price\r\n    ) external returns (uint256) {\r\n        require(bytes(_title).length > 0, \"Title required\");\r\n        require(_price > 0, \"Price must be > 0\");\r\n\r\n        uint256 listingId = listingIdCounter++;\r\n\r\n        serviceListings[listingId] = ServiceListing({\r\n            provider: msg.sender,\r\n            price: _price,\r\n            isActive: true\r\n        });\r\n\r\n        listingTitles[listingId] = _title;\r\n        listingDescriptions[listingId] = _description;\r\n        providerListings[msg.sender].push(listingId);\r\n\r\n        emit ServiceListed(listingId, msg.sender, _price, block.timestamp);\r\n\r\n        return listingId;\r\n    }\r\n\r\n    function delistService(uint256 _listingId) external {\r\n        require(\r\n            serviceListings[_listingId].provider == msg.sender,\r\n            \"Not owner\"\r\n        );\r\n        require(serviceListings[_listingId].isActive, \"Already delisted\");\r\n\r\n        serviceListings[_listingId].isActive = false;\r\n        emit ServiceDelisted(_listingId, block.timestamp);\r\n    }\r\n\r\n    function hireService(\r\n        address _provider,\r\n        string memory _description\r\n    ) external payable returns (uint256) {\r\n        require(_provider != address(0), \"Invalid provider\");\r\n        require(_provider != msg.sender, \"Cannot hire yourself\");\r\n        require(msg.value > 0, \"Payment required\");\r\n\r\n        uint256 jobId = jobIdCounter++;\r\n\r\n        jobs[jobId] = Job({\r\n            provider: _provider,\r\n            client: msg.sender,\r\n            price: msg.value,\r\n            status: 0,\r\n            createdAt: uint40(block.timestamp)\r\n        });\r\n\r\n        jobDescriptions[jobId] = _description;\r\n        providerJobs[_provider].push(jobId);\r\n        clientJobs[msg.sender].push(jobId);\r\n\r\n        emit JobCreated(\r\n            jobId,\r\n            _provider,\r\n            msg.sender,\r\n            msg.value,\r\n            block.timestamp\r\n        );\r\n\r\n        return jobId;\r\n    }\r\n\r\n    function acceptJob(\r\n        uint256 _jobId\r\n    ) external jobExists(_jobId) onlyProvider(_jobId) {\r\n        Job storage job = jobs[_jobId];\r\n        require(job.status == 0, \"Job not pending\");\r\n\r\n        job.status = 1;\r\n        emit JobAccepted(_jobId, block.timestamp);\r\n    }\r\n\r\n    function markJobComplete(\r\n        uint256 _jobId\r\n    ) external jobExists(_jobId) onlyProvider(_jobId) {\r\n        Job storage job = jobs[_jobId];\r\n        require(job.status == 1, \"Job not accepted\");\r\n\r\n        job.status = 2;\r\n        emit JobCompleted(_jobId, block.timestamp);\r\n    }\r\n\r\n    function releasePayment(\r\n        uint256 _jobId\r\n    ) external jobExists(_jobId) onlyClient(_jobId) {\r\n        Job storage job = jobs[_jobId];\r\n        require(job.status == 2, \"Job not completed\");\r\n\r\n        job.status = 3;\r\n\r\n        uint256 platformFee = (job.price * platformFeePercent) / 100;\r\n        uint256 providerAmount = job.price - platformFee;\r\n\r\n        (bool successProvider, ) = job.provider.call{value: providerAmount}(\"\");\r\n        require(successProvider, \"Provider payment failed\");\r\n\r\n        (bool successPlatform, ) = platformWallet.call{value: platformFee}(\"\");\r\n        require(successPlatform, \"Platform fee failed\");\r\n\r\n        emit PaymentReleased(\r\n            _jobId,\r\n            job.provider,\r\n            providerAmount,\r\n            block.timestamp\r\n        );\r\n    }\r\n\r\n    function cancelJob(\r\n        uint256 _jobId\r\n    ) external jobExists(_jobId) onlyClient(_jobId) {\r\n        Job storage job = jobs[_jobId];\r\n        require(job.status == 0, \"Cannot cancel accepted job\");\r\n\r\n        job.status = 4;\r\n\r\n        (bool success, ) = job.client.call{value: job.price}(\"\");\r\n        require(success, \"Refund failed\");\r\n\r\n        emit JobCancelled(_jobId, block.timestamp);\r\n    }\r\n\r\n    function getProviderJobs(\r\n        address _provider\r\n    ) external view returns (uint256[] memory) {\r\n        return providerJobs[_provider];\r\n    }\r\n\r\n    function getClientJobs(\r\n        address _client\r\n    ) external view returns (uint256[] memory) {\r\n        return clientJobs[_client];\r\n    }\r\n\r\n    function getProviderListings(\r\n        address _provider\r\n    ) external view returns (uint256[] memory) {\r\n        return providerListings[_provider];\r\n    }\r\n\r\n    function getJob(\r\n        uint256 _jobId\r\n    ) external view jobExists(_jobId) returns (Job memory) {\r\n        return jobs[_jobId];\r\n    }\r\n\r\n    function getJobDescription(\r\n        uint256 _jobId\r\n    ) external view returns (string memory) {\r\n        return jobDescriptions[_jobId];\r\n    }\r\n\r\n    function getListing(\r\n        uint256 _listingId\r\n    )\r\n        external\r\n        view\r\n        returns (\r\n            string memory title,\r\n            string memory description,\r\n            ServiceListing memory listing\r\n        )\r\n    {\r\n        return (\r\n            listingTitles[_listingId],\r\n            listingDescriptions[_listingId],\r\n            serviceListings[_listingId]\r\n        );\r\n    }\r\n}\r\n"
      }
    }
  }
}